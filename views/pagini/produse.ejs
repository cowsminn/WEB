<!DOCTYPE html>
<html lang="ro">
<head>
    <%- include('../fragmente/head', { titlu: 'Produse - ElectroDelicii' }) %>
    <meta name="description" content="Descoperă colecția noastră de produse vintage și antichități.">
    <meta name="keywords" content="produse, vintage, antichități, electronică, mobilier">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/src/css/produse.css" type="text/css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <%- include('../fragmente/header') %>
    
    <main class="container-fluid">
        <!-- Header secțiune produse -->
        <section id="produse-header" class="text-center py-4 mb-4">
            <h1 class="display-4">Produse ElectroDelicii</h1>
            <% if (categoriaSelectata) { %>
                <p class="lead">Categoria: <strong><%= categoriaSelectata.charAt(0).toUpperCase() + categoriaSelectata.slice(1) %></strong></p>
            <% } else { %>
                <p class="lead">Toate produsele din colecția noastră</p>
            <% } %>
        </section>

        <!-- Secțiunea de filtre -->
        <section id="filtre-sectiune" class="card shadow-sm mb-4">
            <div class="card-header">
                <h2 class="card-title mb-0">
                    <i class="bi bi-funnel"></i> Filtrează și sortează produsele
                </h2>
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <!-- Filtru text pentru nume produs (floating label) -->
                    <div class="col-md-6 col-lg-4">
                        <div class="form-floating">
                            <textarea class="form-control" id="filtru-nume" placeholder="Introduceți numele produsului..." style="height: 100px"></textarea>
                            <label for="filtru-nume">
                                <i class="bi bi-search"></i> Caută după nume
                            </label>
                        </div>
                    </div>

                    <!-- Filtru text pentru descriere -->
                    <div class="col-md-6 col-lg-4">
                        <label for="filtru-descriere" class="form-label">
                            <i class="bi bi-file-text"></i> Cuvânt cheie în descriere
                        </label>
                        <input type="text" class="form-control" id="filtru-descriere" placeholder="Căutați în descriere...">
                    </div>

                    <!-- Filtru range pentru preț -->
                    <div class="col-md-6 col-lg-4">
                        <label for="filtru-pret" class="form-label">
                            <i class="bi bi-currency-exchange"></i> Preț maxim (RON)
                        </label>
                        <div class="d-flex align-items-center">
                            <span class="me-2 text-muted">0</span>
                            <input type="range" class="form-range flex-grow-1" id="filtru-pret" min="0" max="4000" value="4000" step="50">
                            <span class="ms-2 fw-bold">4000 (<span id="pret-selectat">4000</span>)</span>
                        </div>
                    </div>

                    <!-- Datalist pentru tip prezentare -->
                    <div class="col-md-6 col-lg-4">
                        <label for="filtru-tip" class="form-label">
                            <i class="bi bi-truck"></i> Tip prezentare
                        </label>
                        <input list="tip-options" class="form-control" id="filtru-tip" placeholder="Alegeți tipul...">
                        <datalist id="tip-options">
                            <option value="curier_rapid">
                            <option value="curier_standard">
                            <option value="posta_standard">
                            <option value="ridicare_magazin">
                            <option value="curier_mobila">
                            <option value="transport_specializat">
                        </datalist>
                    </div>

                    <!-- Radio buttons pentru culoare (toggle buttons) -->
                    <div class="col-md-6 col-lg-8">
                        <label class="form-label">
                            <i class="bi bi-palette"></i> Culoare
                        </label>
                        <div class="btn-group-vertical btn-group-sm w-100" role="group" data-bs-toggle="buttons">
                            <input type="radio" class="btn-check" name="culoare" id="culoare-toate" value="" checked>
                            <label class="btn btn-outline-primary" for="culoare-toate">Toate culorile</label>
                            
                            <% if (typeof culori !== 'undefined' && culori) { %>
                                <% culori.forEach(function(culoare) { %>
                                    <input type="radio" class="btn-check" name="culoare" id="culoare-<%= culoare %>" value="<%= culoare %>">
                                    <label class="btn btn-outline-primary" for="culoare-<%= culoare %>"><%= culoare.charAt(0).toUpperCase() + culoare.slice(1) %></label>
                                <% }); %>
                            <% } %>
                        </div>
                    </div>

                    <!-- Checkbox pentru noutăți (toggle button) -->
                    <div class="col-md-6 col-lg-4">
                        <label class="form-label">
                            <i class="bi bi-star"></i> Filtre speciale
                        </label>
                        <div class="btn-group-vertical w-100" role="group">
                            <input type="checkbox" class="btn-check" id="filtru-noutati">
                            <label class="btn btn-outline-secondary" for="filtru-noutati">
                                <i class="bi bi-clock"></i> Noutăți (după 1 martie 2024)
                            </label>
                            
                            <input type="checkbox" class="btn-check" id="filtru-garantie">
                            <label class="btn btn-outline-secondary" for="filtru-garantie">
                                <i class="bi bi-shield-check"></i> Cu garanție
                            </label>
                        </div>
                    </div>

                    <!-- Select simplu pentru categorie -->
                    <div class="col-md-6 col-lg-4">
                        <label for="filtru-categorie" class="form-label">
                            <i class="bi bi-tags"></i> Categorie
                        </label>
                        <select class="form-select" id="filtru-categorie">
                            <option value="">Toate categoriile</option>
                            <% if (typeof categorii !== 'undefined' && categorii) { %>
                                <% categorii.forEach(function(categorie) { %>
                                    <option value="<%= categorie %>" <%= categoriaSelectata === categorie ? 'selected' : '' %>>
                                        <%= categorie.charAt(0).toUpperCase() + categorie.slice(1) %>
                                    </option>
                                <% }); %>
                            <% } %>
                        </select>
                    </div>

                    <!-- Select multiplu pentru caracteristici speciale -->
                    <div class="col-md-6 col-lg-4">
                        <label for="filtru-caracteristici" class="form-label">
                            <i class="bi bi-gear"></i> Caracteristici speciale
                        </label>
                        <select class="form-select" id="filtru-caracteristici" multiple size="4">
                            <option value="vintage">Vintage</option>
                            <option value="design_retro">Design retro</option>
                            <option value="lampi">Cu lămpi</option>
                            <option value="functie_completa">Funcție completă</option>
                            <option value="certificat">Cu certificat</option>
                            <option value="manual_original">Manual original</option>
                            <option value="stare_perfecta">Stare perfectă</option>
                        </select>
                    </div>
                </div>

                <!-- Butoane de control -->
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="d-flex flex-wrap gap-2 justify-content-center">
                            <button id="btn-filtreaza" class="btn btn-primary btn-lg">
                                <i class="bi bi-funnel-fill"></i>
                                <span class="btn-text ms-1">Filtrează</span>
                            </button>
                            <button id="btn-sorteaza-asc" class="btn btn-secondary">
                                <i class="bi bi-sort-alpha-down"></i>
                                <span class="btn-text ms-1">Sortează A-Z</span>
                            </button>
                            <button id="btn-sorteaza-desc" class="btn btn-secondary">
                                <i class="bi bi-sort-alpha-up"></i>
                                <span class="btn-text ms-1">Sortează Z-A</span>
                            </button>
                            <button id="btn-calculeaza" class="btn btn-info">
                                <i class="bi bi-calculator"></i>
                                <span class="btn-text ms-1">Calculează prețul mediu</span>
                            </button>
                            <button id="btn-reseteaza" class="btn btn-warning">
                                <i class="bi bi-arrow-clockwise"></i>
                                <span class="btn-text ms-1">Resetează filtrele</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Sectiunea cu produsele -->
        <section id="produse-lista">
            <% if (produse && produse.length > 0) { %>
                <div class="row g-4" id="produse-container">
                    <% produse.forEach(function(produs) { %>
                        <div class="col-lg-6 col-xl-4">
                            <article id="artc-<%= produs.id %>" class="card h-100 produs-card <%= produs.categorie_mare %>" 
                                     data-nume="<%= produs.nume.toLowerCase() %>"
                                     data-descriere="<%= produs.descriere.toLowerCase() %>"
                                     data-pret="<%= produs.pret %>"
                                     data-dimensiune="<%= produs.dimensiune %>"
                                     data-categorie="<%= produs.categorie_mare %>"
                                     data-culoare="<%= produs.culoare %>"
                                     data-tip="<%= produs.tip_prezentare %>"
                                     data-data="<%= produs.data_introducere %>"
                                     data-caracteristici="<%= produs.caracteristici_speciale || '' %>"
                                     data-garantie="<%= produs.garantie %>">
                                
                                <div class="row g-0 h-100">
                                    <!-- Prima coloană: Imagine și caracteristici -->
                                    <div class="col-md-5">
                                        <img src="/src/img/produse/<%= produs.imagine %>" 
                                             class="img-fluid rounded-start h-100 object-fit-cover" 
                                             alt="<%= produs.nume %>" 
                                             title="<%= produs.nume %>">
                                    </div>

                                    <!-- A doua coloană: Categorie și descriere -->
                                    <div class="col-md-7">
                                        <div class="card-body d-flex flex-column h-100">
                                            <h5 class="card-title">
                                                <a href="/produs/<%= produs.id %>" class="text-decoration-none">
                                                    <%= produs.nume %>
                                                </a>
                                            </h5>
                                            <p class="card-text">
                                                <small class="text-muted">
                                                    <i class="bi bi-tag"></i> 
                                                    <%= produs.categorie_mare.charAt(0).toUpperCase() + produs.categorie_mare.slice(1) %>
                                                </small>
                                            </p>
                                            <p class="card-text flex-grow-1"><%= produs.descriere %></p>
                                            
                                            <!-- Caracteristici în listă compactă -->
                                            <ul class="list-unstyled small mb-3">
                                                <li><strong>Preț:</strong> <span class="text-primary"><%= produs.pret %> RON</span></li>
                                                <li><strong>Dimensiune:</strong> <%= produs.dimensiune %> cm</li>
                                                <li><strong>Culoare:</strong> <%= produs.culoare %></li>
                                                <li><strong>Garanție:</strong> 
                                                    <% if (produs.garantie) { %>
                                                        <span class="badge bg-success">Da</span>
                                                    <% } else { %>
                                                        <span class="badge bg-secondary">Nu</span>
                                                    <% } %>
                                                </li>
                                            </ul>
                                            
                                            <div class="mt-auto">
                                                <a href="/produs/<%= produs.id %>" class="btn btn-primary">
                                                    <i class="bi bi-eye"></i> Vezi detalii
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </article>
                        </div>
                    <% }); %>
                </div>
            <% } else { %>
                <div class="alert alert-info text-center">
                    <i class="bi bi-info-circle"></i>
                    Nu au fost găsite produse pentru categoria selectată.
                </div>
            <% } %>
        </section>
    </main>
    
    <%- include('../fragmente/footer') %>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/src/js/produse-filtre.js"></script>
</body>
</html>